<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FarmStock - Inventario</title>
  <link rel="stylesheet" href="../CSS/iventario.css" />
</head>

<body>
  <div class="container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="top-section">
        <div class="logo">
          <img src="../imagenes/Logo.png" alt="Logo del sitio" />
        </div>
        <ul class="menu-modulos">
          <li><a href="../HTML/index.html">Registro Herramientas</a></li>
          <li><a href="../HTML/registro-salida.html">Historial de herramientas</a></li>
          <li><a href="../HTML/indexInventario.html" class="active">Inventario</a></li>
          <li><a href="notificaciones.html">Notificaciones</a></li>
          <li><a href="../HTML/estats.html">Estad√≠sticas</a></li>
        </ul>
      </div>
      <div class="sidebar-bottom">
        <a href="quienes-somos.html" class="somos">üë• Qui√©nes Somos</a>
        <div class="night-mode">
          <span>üåô Modo noche</span>
        </div>
      </div>
    </aside>

    <!-- Contenido principal -->
    <main class="main-content">
      <!-- Usuario arriba -->
      <div class="bienvenida">
        <img src="../imagenes/Maria.png" alt="Foto de usuario" class="foto-usuario" />
        <p><strong>¬°Hola Maria!</strong></p>
      </div>

      <!-- Panel blanco -->
      <div class="cuadro-visual">
        <div class="encabezado-panel">
          <h1>Inventario</h1>
          <div class="menu-verde-completo">
            <span class="menu-verde-label">Ver desde</span>
            <select id="filtroTiempo" class="menu-verde-select">
              <option value="hoy">Hoy</option>
              <option value="semana">√öltima semana</option>
              <option value="mes">√öltimo mes</option>
              <option value="3meses" selected>3 meses</option>
              <option value="todo">Todo</option>
            </select>
          </div>
        </div>

        <!-- Aqu√≠ se insertar√°n las tarjetas -->
        <div id="inventarioLista" class="tarjetas-container"></div>
      </div>
    </main>
  </div>

  <!-- Script para mostrar herramientas -->
  <script>
    function mostrarInventario(filtro = "3meses") {
      let herramientas = JSON.parse(localStorage.getItem("herramientas")) || [];
      const contenedor = document.getElementById("inventarioLista");
      contenedor.innerHTML = "";

      const hoy = new Date();

      herramientas.forEach(h => {
        let fechaHerramienta = new Date(h.fecha);
        let mostrar = true;

        if (filtro === "hoy") {
          mostrar = fechaHerramienta.toDateString() === hoy.toDateString();
        } else if (filtro === "semana") {
          let semanaPasada = new Date();
          semanaPasada.setDate(hoy.getDate() - 7);
          mostrar = fechaHerramienta >= semanaPasada;
        } else if (filtro === "mes") {
          let mesPasado = new Date();
          mesPasado.setMonth(hoy.getMonth() - 1);
          mostrar = fechaHerramienta >= mesPasado;
        } else if (filtro === "3meses") {
          let tresMeses = new Date();
          tresMeses.setMonth(hoy.getMonth() - 3);
          mostrar = fechaHerramienta >= tresMeses;
        }

        if (mostrar) {
          let tarjeta = `
            <div class="tarjeta herramienta-card">
              <h3>üõ†Ô∏è ${h.nombre}</h3>
              <p><strong>Estado:</strong> ${h.estado}</p>
              <p><strong>Tipo:</strong> ${h.tipo}</p>
              <p><strong>Ubicaci√≥n:</strong> ${h.ubicacion}</p>
              <p><strong>Fecha ingreso:</strong> ${h.fecha}</p>
              <p><strong>Lote:</strong> ${h.lote}</p>
              <p><strong>Descripci√≥n:</strong> ${h.descripcion}</p>
            </div>
          `;
          contenedor.innerHTML += tarjeta;
        }
      });

      if (contenedor.innerHTML === "") {
        contenedor.innerHTML = "<p>No hay herramientas registradas en este rango de tiempo.</p>";
      }
    }

    // Detectar cambios en el filtro
    document.getElementById("filtroTiempo").addEventListener("change", function () {
      mostrarInventario(this.value);
    });

    // Cargar al abrir la p√°gina
    mostrarInventario();
  </script>
</body>
</html>